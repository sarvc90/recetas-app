name: üîí Block Properties and POM Changes
on:
  pull_request:
    types: [opened, synchronize, reopened, edited]

jobs:
  check-critical-files:
    runs-on: ubuntu-latest
    steps:
      - name: ‚¨áÔ∏è Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: üîç Check for modified properties/pom files
        run: |
          echo "Checking for modifications in critical files..."
          
          # Obtener archivos modificados en el PR
          git fetch origin ${{ github.base_ref }}
          MODIFIED_FILES=$(git diff --name-only origin/${{ github.base_ref }}...HEAD)
          
          echo "Modified files:"
          echo "$MODIFIED_FILES"
          echo ""
          
          # Buscar archivos cr√≠ticos (pom.xml o .properties)
          CRITICAL_FILES=$(echo "$MODIFIED_FILES" | grep -E '(pom\.xml|\.properties)$') || true
          
          if [ -n "$CRITICAL_FILES" ]; then
            echo "‚ùå ERROR: No se permiten modificaciones en:"
            echo "$CRITICAL_FILES"
            echo ""
            echo "üìã Reglas:"
            echo "- pom.xml ‚Üí BLOQUEADO"
            echo "- *.properties ‚Üí BLOQUEADO"
            echo ""
            echo "üí° Solo los administradores pueden modificar estos archivos"
            exit 1
          fi
          
          echo "‚úÖ No se modificaron archivos cr√≠ticos"
          echo "‚úÖ PR aprobado para merge"